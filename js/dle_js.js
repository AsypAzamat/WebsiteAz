var c_cache=[],dle_poll_voted=[];function reload(){var e=(new Date).getTime();document.getElementById("dle-captcha").innerHTML='<img src="'+dle_root+"engine/modules/antibot/antibot.php?rndval="+e+'" width="160" height="80" alt="" />'}function dle_change_sort(e,o){var t=document.getElementById("news_set_sort");return t.dlenewssortby.value=e,t.dledirection.value=o,t.submit(),!1}function doPoll(e,o){var t=document.getElementById("dlepollform_"+o),n=t.status.value,i="";if(1!=dle_poll_voted[o]){if("results"!=e&&1!=n){for(var d=0;d<t.elements.length;d++){var l=t.elements[d];if("radio"==l.type&&1==l.checked){i=l.value;break}"checkbox"==l.type&&1==l.checked&&(i=i+l.value+" ")}if("vote"==e&&""==i)return;dle_poll_voted[o]=1}else n=1,t.status.value=1;1==n&&"vote"==e&&(n=0,t.status.value=0,e="list"),ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=poll",{news_id:o,action:e,answer:i,dle_skin:dle_skin,user_hash:dle_login_hash},(function(e){HideLoading(""),$("#dle-poll-list-"+o).fadeOut(500,(function(){$(this).html(e),$(this).fadeIn(500)}))}))}}function IPMenu(e,o,t,n){var i=[];return i[0]='<a href="https://www.nic.ru/whois/?searchWord='+e+'" target="_blank">'+o+"</a>",i[1]='<a href="'+dle_root+dle_admin+"?mod=iptools&ip="+e+'" target="_blank">'+t+"</a>",i[2]='<a href="'+dle_root+dle_admin+"?mod=blockip&ip="+e+'" target="_blank">'+n+"</a>",i}function ajax_save_for_edit(e,o){var t={};return"2"==quick_wysiwyg&&tinyMCE.triggerSave(),$.each($("#ajaxnews"+e).serializeArray(),(function(e,o){t[o.name]=o.value})),t.id=e,t.field=o,t.action="save",t.user_hash=dle_login_hash,ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=editnews",t,(function(e){HideLoading(""),"ok"!=e?DLEalert(e,dle_info):($("#dlepopup-news-edit").dialog("close"),DLEconfirm(dle_save_ok,dle_confirm,(function(){location.reload(!0)})))})),!1}function ajax_prep_for_edit(e,o){for(var t=0,n=c_cache.length;t<n;t++)t in c_cache&&(c_cache[t]||""!=c_cache[t])&&ajax_cancel_comm_edit(t);return ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=editnews",{id:e,field:o,action:"edit"},(function(t){HideLoading("");var n="none";$("#modal-overlay").remove(),$("body").prepend('<div id="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #666666; opacity: .40;filter:Alpha(Opacity=40); z-index: 999; display:none;"></div>'),$("#modal-overlay").css({filter:"alpha(opacity=40)"}).fadeIn();var i={};i[dle_act_lang[3]]=function(){$(this).dialog("close")},i[dle_act_lang[4]]=function(){ajax_save_for_edit(e,o)},$("#dlepopup-news-edit").remove(),$("body").prepend("<div id='dlepopup-news-edit' class='dlepopupnewsedit' title='"+menu_short+"' style='display:none'></div>"),$(".dlepopupnewsedit").html("");var d=.9*$(window).height(),l=.9*$(window).width();1024<l&&(l=1024),$("#dlepopup-news-edit").dialog({autoOpen:!0,width:l,height:d,buttons:i,resizable:!1,dialogClass:"modalfixed dle-popup-quickedit",dragStart:function(e,o){n=$(".modalfixed").css("box-shadow"),$(".modalfixed").css("box-shadow","none")},dragStop:function(e,o){$(".modalfixed").css("box-shadow",n)},close:function(e,o){$(this).dialog("destroy"),$("#modal-overlay").fadeOut((function(){$("#modal-overlay").remove()}))}}),830<$(window).width()&&530<$(window).height()&&($(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup-news-edit").dialog("option","position",{my:"center",at:"center",of:window})),$("#dlepopup-news-edit").css({overflow:"auto"}),$("#dlepopup-news-edit").css({"overflow-x":"hidden"}),$("#dlepopup-news-edit").html(t)}),"html"),!1}function ajax_comm_edit(e,o){for(var t=0,n=c_cache.length;t<n;t++)t in c_cache&&""!=c_cache[t]&&ajax_cancel_comm_edit(t);return c_cache[e]&&""!=c_cache[e]||(c_cache[e]=$("#comm-id-"+e).html()),ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=editcomments",{id:e,area:o,action:"edit"},(function(o){HideLoading(""),$("#comm-id-"+e).html(o),setTimeout((function(){$("html,body").stop().animate({scrollTop:$("#comm-id-"+e).offset().top-100},700)}),100)}),"html"),!1}function ajax_cancel_comm_edit(e){return""!=c_cache[e]&&$("#comm-id-"+e).html(c_cache[e]),c_cache[e]="",!1}function ajax_save_comm_edit(e,o){"2"==dle_wysiwyg&&tinyMCE.triggerSave();var t=$("#dleeditcomments"+e).val();return ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=editcomments",{id:e,comm_txt:t,area:o,action:"save",user_hash:dle_login_hash},(function(o){HideLoading(""),c_cache[e]="",$("#comm-id-"+e).html(o)})),!1}function DeleteComments(e,o){DLEconfirm(dle_del_agree,dle_confirm,(function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=deletecomments",{id:e,dle_allow_hash:o},(function(e){if(HideLoading(""),e=parseInt(e),!isNaN(e)){var o=null;o="1"==dle_tree_comm?$("#comments-tree-item-"+e):$("#comment-id-"+e),$("html,body").stop().animate({scrollTop:o.offset().top-70},700),setTimeout((function(){o.hide("blind",{},1400)}),700)}}))}))}function MarkSpam(e,o){DLEconfirm(dle_spam_agree,dle_confirm,(function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=adminfunction",{id:e,action:"commentsspam",user_hash:o},(function(e){HideLoading(""),"error"!=e&&DLEconfirm(e,dle_confirm,(function(){location.reload(!0)}))}))}))}function doFavorites(e,o,t){return ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=favorites",{fav_id:e,action:o,skin:dle_skin,alert:t,user_hash:dle_login_hash},(function(o){HideLoading(""),t?DLEalert(o,dle_info):$("#fav-id-"+e).html(o)})),!1}function CheckLogin(){var e=document.getElementById("name").value;return ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=registration",{name:e,user_hash:dle_login_hash},(function(e){HideLoading(""),$("#result-registration").html(e)})),!1}function doCalendar(e,o,t){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=calendar",{month:e,year:o},(function(e){HideLoading(""),"left"==t?$("#calendar-layer").hide("slide",{direction:"left"},500,(function(){$("#calendar-layer").html(e).show("slide",{direction:"right"},500)})):$("#calendar-layer").hide("slide",{direction:"right"},500,(function(){$("#calendar-layer").html(e).show("slide",{direction:"left"},500)}))}))}function doRate(e,o){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=rating",{go_rate:e,news_id:o,skin:dle_skin,user_hash:dle_login_hash},(function(e){if(HideLoading(""),e.success){var t=e.rating;t=(t=(t=t.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),$("#ratig-layer-"+o).html(t),$("#vote-num-id-"+o).html(e.votenum),$("#likes-id-"+o).html(e.likes),$("#dislikes-id-"+o).html(e.dislikes)}else e.error&&DLEalert(e.errorinfo,dle_info)}),"json")}function doCommentsRate(e,o){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=ratingcomments",{go_rate:e,c_id:o,skin:dle_skin,user_hash:dle_login_hash},(function(e){if(HideLoading(""),e.success){var t=e.rating;t=(t=(t=t.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),$("#comments-ratig-layer-"+o).html(t),$("#comments-vote-num-id-"+o).html(e.votenum),$("#comments-likes-id-"+o).html(e.likes),$("#comments-dislikes-id-"+o).html(e.dislikes)}else e.error&&DLEalert(e.errorinfo,dle_info)}),"json")}function ajax_cancel_reply(){$("#dlefastreplycomments").hide("blind",{},1400)}function ajax_fast_reply(e,o){var t=$("#comments"+e).val(),n=$("#name"+e).val(),i=$("#question_answer"+e).val(),d=$("#sec_code"+e).val(),l=$("#subscribe"+e+":checked").val(),a=$("#postid"+e).val(),s="";return""==n||""==t?(DLEalert(dle_req_field,dle_info),!1):("1"==dle_captcha_type?"undefined"!=typeof grecaptcha&&(s=grecaptcha.getResponse(recaptcha_widget)):"2"==dle_captcha_type&&(s=$("#comments-recaptcha-response"+e).val()),l||(l=0),d||(d=""),i||(i=""),ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=addcomments",{post_id:a,parent:e,indent:o,comments:t,name:n,mail:"",editor_mode:"",skin:dle_skin,sec_code:d,question_answer:i,g_recaptcha_response:s,allow_subscribe:l,user_hash:dle_login_hash},(function(o){HideLoading(""),$("#blind-animation"+e).remove(),$("#dlefastreplyesponse").html(o),"error"!=o&&document.getElementById("blind-animation"+e)&&($("html,body").stop().animate({scrollTop:$("#dlefastreplyesponse").offset().top-100},600),setTimeout((function(){$("#blind-animation"+e).show("blind",{},700),$("#dlefastreplycomments").hide("blind",{},700)}),600))}),"html"),!1)}function DLESendPM(e){var o={};return $("#dlesendpmpopup").remove(),$("#dleprofilepopup").remove(),o[dle_act_lang[3]]=function(){$(this).dialog("close")},o[dle_p_send]=function(){"2"==dle_wysiwyg&&tinyMCE.triggerSave();var e=$("#pm_subj").val(),o=$("#pm_text").val(),t=$("#pm_name").val(),n=$("#pm_question_answer").val(),i=$("#sec_code_pm").val(),d=$("#outboxcopy:checked").val(),l="";return""==t||""==o||""==e?(DLEalert(dle_req_field,dle_info),!1):("1"==dle_captcha_type?"undefined"!=typeof grecaptcha&&(l=grecaptcha.getResponse(recaptcha_widget)):"2"==dle_captcha_type&&(l=$("#pm-recaptcha-response").val()),d||(d=0),i||(i=""),n||(n=""),ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=pm",{action:"send_pm",subj:e,comments:o,name:t,skin:dle_skin,sec_code:i,question_answer:n,g_recaptcha_response:l,outboxcopy:d,user_hash:dle_login_hash},(function(e){if(HideLoading(""),e.success)$("#dlesendpmpopup").remove(),DLEalert(e.success,dle_info);else if(e.error){if("2"==dle_captcha_type&&"undefined"!=typeof grecaptcha){var o=$("#pm-recaptcha-response").data("key");grecaptcha.execute(o,{action:"pm"}).then((function(e){$("#pm-recaptcha-response").val(e)}))}DLEalert(e.error,dle_info)}}),"json"),!1)},ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=pm",{name:e,action:"show_send",skin:dle_skin,user_hash:dle_login_hash},(function(e){HideLoading(""),$("body").append(e),$("#dlesendpmpopup").dialog({autoOpen:!0,width:800,resizable:!1,dialogClass:"modalfixed dle-popup-sendpm",buttons:o}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlesendpmpopup").dialog("option","position",{my:"center",at:"center",of:window})}),"html"),!1}function dle_reply(e,o,t){var n={},i="";return $("#dlereplypopup").remove(),"1"==t&&($("#dlefastreplycomments").remove(),$("#dlefastreplyesponse").remove()),n[dle_act_lang[3]]=function(){$(this).dialog("close")},n[dle_p_send]=function(){"1"!=dle_wysiwyg&&"2"!=dle_wysiwyg||("2"==dle_wysiwyg&&tinyMCE.triggerSave(),i="wysiwyg");var t=$("#comments"+e).val(),n=$("#name"+e).val(),d=$("#mail"+e).val(),l=$("#question_answer"+e).val(),a=$("#sec_code"+e).val(),s=$("#subscribe"+e+":checked").val(),r=$("#postid"+e).val(),p="";return""==n||""==t?(DLEalert(dle_req_field,dle_info),!1):("1"==dle_captcha_type?"undefined"!=typeof grecaptcha&&(p=grecaptcha.getResponse(recaptcha_widget)):"2"==dle_captcha_type&&(p=$("#comments-recaptcha-response"+e).val()),s||(s=0),a||(a=""),l||(l=""),ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=addcomments",{post_id:r,parent:e,indent:o,comments:t,name:n,mail:d,editor_mode:i,skin:dle_skin,sec_code:a,question_answer:l,g_recaptcha_response:p,allow_subscribe:s,user_hash:dle_login_hash},(function(o){HideLoading(""),$("#blind-animation"+e).remove(),$("#comments-tree-item-"+e).length?($("#comments-tree-item-"+e).append(o),"error"!=o&&document.getElementById("blind-animation"+e)&&($("#dlereplypopup").remove(),$("html,body").stop().animate({scrollTop:$("#comments-tree-item-"+e).offset().top+$("#comments-tree-item-"+e).height()-100},600),setTimeout((function(){$("#blind-animation"+e).show("blind",{},700)}),600))):$("#comment-id-"+e).length&&($("#comment-id-"+e).append(o),"error"!=o&&document.getElementById("blind-animation"+e)&&($("#dlereplypopup").remove(),$("html,body").stop().animate({scrollTop:$("#comment-id-"+e).offset().top+$("#comment-id-"+e).height()-100},600),setTimeout((function(){$("#blind-animation"+e).show("blind",{},700)}),600)))}),"html"),!1)},ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=replycomments",{id:e,indent:o,skin:dle_skin,user_hash:dle_login_hash},(function(o){HideLoading(""),"1"==t?($("#comment-id-"+e).append("<div id='dlefastreplyesponse'></div><div id='dlefastreplycomments' style='display:none'></div>"),$("#dlefastreplycomments").html(o),$("html,body").stop().animate({scrollTop:$("#comment-id-"+e).offset().top+$("#comment-id-"+e).height()-100},600),setTimeout((function(){$("#dlefastreplycomments").show("blind",{},700)}),600)):($("body").append("<div id='dlereplypopup' title='"+dle_reply_title+"' style='display:none'></div>"),$("#dlereplypopup").html(o),$("#dlereplypopup").dialog({autoOpen:!0,width:800,resizable:!1,dialogClass:"modalfixed dle-popup-replycomments",buttons:n}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlereplypopup").dialog("option","position",{my:"center",at:"center",of:window}))}),"html"),!1}function doAddComments(){var e=document.getElementById("dle-comments-form"),o="",t="",n="",i="",d="0",l="";return"1"!=dle_wysiwyg&&"2"!=dle_wysiwyg||("2"==dle_wysiwyg&&tinyMCE.triggerSave(),o="wysiwyg"),""==e.comments.value||""==e.name.value?(DLEalert(dle_req_field,dle_info),!1):(e.question_answer&&(t=e.question_answer.value),e.sec_code&&(n=e.sec_code.value),"1"==dle_captcha_type?"undefined"!=typeof grecaptcha&&(i=grecaptcha.getResponse()):"2"==dle_captcha_type&&(i=$("#g-recaptcha-response").val()),e.allow_subscribe&&1==e.allow_subscribe.checked&&(d="1"),e.mail&&(l=e.mail.value),ShowLoading(""),$.post(dle_root+"engine/ajax/controller.php?mod=addcomments",{post_id:e.post_id.value,comments:e.comments.value,name:e.name.value,mail:l,editor_mode:o,skin:dle_skin,sec_code:n,question_answer:t,g_recaptcha_response:i,allow_subscribe:d,user_hash:dle_login_hash},(function(o){HideLoading(""),$("#dle-ajax-comments").html(o),"error"!=o&&document.getElementById("blind-animation")&&($("html,body").stop().animate({scrollTop:$("#dle-ajax-comments").offset().top-100},600),setTimeout((function(){$("#blind-animation").show("blind",{},700)}),600),e.sec_code&&(e.sec_code.value="",reload()),"1"==dle_captcha_type?"undefined"!=typeof grecaptcha&&grecaptcha.reset():"2"==dle_captcha_type&&"undefined"!=typeof grecaptcha&&(o=$("#g-recaptcha-response").data("key"),grecaptcha.execute(o,{action:"comments"}).then((function(e){$("#g-recaptcha-response").val(e)}))))}),"html"),!1)}function isHistoryApiAvailable(){return!(!window.history||!history.pushState)}function CommentsPage(e,o,t){return ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=comments",{cstart:e,news_id:o,skin:dle_skin},(function(n){HideLoading(""),isNaN(e)||isNaN(o)||($("#dle-comm-link").off("click"),$("#dle-comm-link").on("click",(function(){return CommentsPage(e,o),!1}))),scroll(0,$("#dle-comments-list").offset().top-100),$("#dle-comments-list").html(n.comments),$(".dle-comments-navigation").html(n.navigation),isHistoryApiAvailable()&&window.history.pushState(null,null,t)}),"json"),!1}function dle_copy_quote(e){dle_txt="",window.getSelection?dle_txt=window.getSelection():document.selection&&(dle_txt=document.selection.createRange().text),""!=dle_txt&&(dle_txt="[quote="+e+"]"+dle_txt+"[/quote]")}function dle_fastreply(e){if(!document.getElementById("dle-comments-form"))return!1;var o=document.getElementById("dle-comments-form").comments,t="";return"0"==dle_wysiwyg||"-1"==dle_wysiwyg?(o.value="0"==dle_wysiwyg?o.value+"[b]"+e+"[/b],\n":o.value+(e+",\n"),o.focus()):(t="<b>"+e+"</b>,<br />","1"==dle_wysiwyg?($("#comments").froalaEditor("events.focus"),$("#comments").froalaEditor("html.insert",t,!0)):tinyMCE.execCommand("mceInsertContent",!1,t)),setTimeout((function(){$("html,body").stop().animate({scrollTop:$("#dle-comments-form").offset().top-100},700)}),100),!1}function dle_ins(e){if(!document.getElementById("dle-comments-form"))return!1;var o=document.getElementById("dle-comments-form").comments,t="";return""!=dle_txt?("0"==dle_wysiwyg||"-1"==dle_wysiwyg?(o.value+=dle_txt+"\n",o.focus()):(t=dle_txt+"<br />","1"==dle_wysiwyg?($("#comments").froalaEditor("events.focus"),$("#comments").froalaEditor("html.insert",t,!0)):tinyMCE.execCommand("mceInsertContent",!1,t)),setTimeout((function(){$("html,body").stop().animate({scrollTop:$("#dle-comments-form").offset().top-100},700)}),100)):(ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=quote",{id:e,user_hash:dle_login_hash},(function(e){HideLoading(""),e=(e=(e=(e=(e=(e=(e=e.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&")).replace(/&quot;/g,'"')).replace(/&#039;/g,"'")).replace(/&#039;/g,"'")).replace(/&#34;/g,'"'),"0"==dle_wysiwyg||"-1"==dle_wysiwyg?(o.value+=e+"\n",o.focus()):(t=e+"<br />","1"==dle_wysiwyg?($("#comments").froalaEditor("events.focus"),$("#comments").froalaEditor("html.insert",t,!0)):tinyMCE.execCommand("mceInsertContent",!1,t)),setTimeout((function(){$("html,body").stop().animate({scrollTop:$("#dle-comments-form").offset().top-100},700)}),100)}))),!1}function ShowOrHide(e){var o=$("#"+e),t=null;document.getElementById("image-"+e)&&(t=document.getElementById("image-"+e)),3e3<(e=o.height()/200*1e3)&&(e=3e3),250>e&&(e=250),"none"==o.css("display")?(o.show("blind",{},e),t&&(t.src=dle_root+"templates/"+dle_skin+"/dleimages/spoiler-minus.gif")):(2e3<e&&(e=2e3),o.hide("blind",{},e),t&&(t.src=dle_root+"templates/"+dle_skin+"/dleimages/spoiler-plus.gif"))}function ckeck_uncheck_all(){for(var e=document.pmlist,o=0;o<e.elements.length;o++){var t=e.elements[o];"checkbox"==t.type&&(t.checked=1!=e.master_box.checked)}e.master_box.checked=1!=e.master_box.checked}function confirmDelete(e){DLEconfirm(dle_del_agree,dle_confirm,(function(){document.location=e}))}function setNewField(e,o){e!=selField&&(fombj=o,selField=e)}function dle_news_delete(e){var o={};o[dle_act_lang[1]]=function(){$(this).dialog("close")},allow_dle_delete_news&&(o[dle_del_msg]=function(){$(this).dialog("close");var o={};o[dle_act_lang[3]]=function(){$(this).dialog("close")},o[dle_p_send]=function(){if(1>$("#dle-promt-text").val().length)$("#dle-promt-text").addClass("ui-state-error");else{var o=$("#dle-promt-text").val();$(this).dialog("close"),$("#dlepopup").remove(),$.post(dle_root+"engine/ajax/controller.php?mod=message",{id:e,user_hash:dle_login_hash,text:o},(function(o){"ok"==o?document.location=dle_root+"index.php?do=deletenews&id="+e+"&hash="+dle_login_hash:DLEalert("Send Error",dle_info)}))}},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' class='dle-promt' title='"+dle_notice+"' style='display:none'>"+dle_p_text+"<br /><br /><textarea name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;height:100px;'></textarea></div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-newsdelete",buttons:o}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}),o[dle_act_lang[0]]=function(){$(this).dialog("close"),document.location=dle_root+"index.php?do=deletenews&id="+e+"&hash="+dle_login_hash},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' class='dle-promt' title='"+dle_confirm+"' style='display:none'><div id='dlepopupmessage'>"+dle_del_agree+"</div></div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-newsdelete",buttons:o}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}function MenuNewsBuild(e,o){var t=[];return t[0]="<a onclick=\"ajax_prep_for_edit('"+e+"', '"+o+'\'); return false;" href="#">'+menu_short+"</a>",""!=dle_admin&&(t[1]='<a href="'+dle_root+dle_admin+"?mod=editnews&action=editnews&id="+e+'" target="_blank">'+menu_full+"</a>"),allow_dle_delete_news&&(t[2]="<a onclick=\"sendNotice ('"+e+'\'); return false;" href="#">'+dle_notice+"</a>",t[3]="<a onclick=\"dle_news_delete ('"+e+'\'); return false;" href="#">'+dle_del_news+"</a>"),t}function sendNotice(e){var o={};o[dle_act_lang[3]]=function(){$(this).dialog("close")},o[dle_p_send]=function(){if(1>$("#dle-promt-text").val().length)$("#dle-promt-text").addClass("ui-state-error");else{var o=$("#dle-promt-text").val();$(this).dialog("close"),$("#dlepopup").remove(),$.post(dle_root+"engine/ajax/controller.php?mod=message",{id:e,user_hash:dle_login_hash,text:o,allowdelete:"no"},(function(e){"ok"==e&&DLEalert(dle_p_send_ok,dle_info)}))}},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' title='"+dle_notice+"' style='display:none'><br />"+dle_p_text+"<br /><br /><textarea name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;height:100px;'></textarea></div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-sendmessage",buttons:o}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}function AddComplaint(e,o){var t={};t[dle_act_lang[3]]=function(){$(this).dialog("close")},t[dle_p_send]=function(){if(1>$("#dle-promt-text").val().length)$("#dle-promt-text").addClass("ui-state-error");else{var t=$("#dle-promt-text").val();$(this).dialog("close"),$("#dlepopup").remove(),$.post(dle_root+"engine/ajax/controller.php?mod=complaint",{id:e,text:t,action:o,user_hash:dle_login_hash},(function(e){DLEalert("ok"==e?dle_p_send_ok:e,dle_info)}))}},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' title='"+dle_complaint+"' style='display:none'><br /><textarea name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;height:100px;'></textarea></div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-complaint",buttons:t}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}function DLEalert(e,o){$("#dlepopup").remove(),$("body").append("<div id='dlepopup' class='dle-alert' title='"+o+"' style='display:none'>"+e+"</div>"),$("#dlepopup").dialog({autoOpen:!0,width:470,resizable:!1,dialogClass:"modalfixed dle-popup-alert",buttons:{Ok:function(){$(this).dialog("close"),$("#dlepopup").remove()}}}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}function DLEconfirm(e,o,t){var n={};n[dle_act_lang[1]]=function(){$(this).dialog("close"),$("#dlepopup").remove()},n[dle_act_lang[0]]=function(){$(this).dialog("close"),$("#dlepopup").remove(),t&&t()},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' class='dle-confirm' title='"+o+"' style='display:none'>"+e+"</div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-confirm",buttons:n}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}function DLEprompt(e,o,t,n,i){var d={};d[dle_act_lang[3]]=function(){$(this).dialog("close")},d[dle_act_lang[2]]=function(){if(!i&&1>$("#dle-promt-text").val().length)$("#dle-promt-text").addClass("ui-state-error");else{var e=$("#dle-promt-text").val();$(this).dialog("close"),$("#dlepopup").remove(),n&&n(e)}},$("#dlepopup").remove(),$("body").append("<div id='dlepopup' class='dle-promt' title='"+t+"' style='display:none'>"+e+"<br /><br /><input type='text' name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;' value='"+o+"'/></div>"),$("#dlepopup").dialog({autoOpen:!0,width:500,resizable:!1,dialogClass:"modalfixed dle-popup-promt",buttons:d}),$(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window}),0<o.length?$("#dle-promt-text").select().focus():$("#dle-promt-text").focus()}var dle_user_profile="",dle_user_profile_link="";function ShowPopupProfile(e,o){var t={};return t[menu_profile]=function(){document.location=dle_user_profile_link},5!=dle_group&&(t[menu_send]=function(){DLESendPM(dle_user_profile)}),1==o&&(t[menu_uedit]=function(){$(this).dialog("close");var e={};$("body").append('<div id="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #666666; opacity: .40;filter:Alpha(Opacity=40); z-index: 999; display:none;"></div>'),$("#modal-overlay").css({filter:"alpha(opacity=40)"}).fadeIn("slow"),$("#dleuserpopup").remove(),$("body").append("<div id='dleuserpopup' title='"+menu_uedit+"' style='display:none'></div>"),e[dle_act_lang[3]]=function(){$(this).dialog("close"),$("#dleuserpopup").remove()},e[dle_act_lang[5]]=function(){window.frames.edituserframe.confirmDelete(dle_login_hash)},e[dle_act_lang[4]]=function(){document.getElementById("edituserframe").contentWindow.document.getElementById("saveuserform").submit()},$("#dleuserpopup").dialog({autoOpen:!0,show:"fade",width:700,resizable:!1,dialogClass:"modalfixed dle-popup-userprofileadmin",buttons:e,open:function(e,o){$("#dleuserpopup").html("<iframe name='edituserframe' id='edituserframe' width='100%' height='400' src='"+dle_root+dle_admin+"?mod=editusers&action=edituser&user="+dle_user_profile+"&skin="+dle_skin+"' frameborder='0' marginwidth='0' marginheight='0' allowtransparency='true'></iframe>")},beforeClose:function(e,o){$("#dleuserpopup").html("")},close:function(e,o){$("#modal-overlay").fadeOut("slow",(function(){$("#modal-overlay").remove()}))}}),830<$(window).width()&&530<$(window).height()&&($(".modalfixed.ui-dialog").css({position:"fixed"}),$("#dleuserpopup").dialog("option","position",{my:"center",at:"center",of:window}))}),$("#dleprofilepopup").remove(),$("body").append(e),$("#dleprofilepopup").dialog({autoOpen:!0,show:"fade",hide:"fade",resizable:!1,dialogClass:"dle-popup-userprofile",buttons:t,width:550}),!1}function ShowProfile(e,o,t){return dle_user_profile==e&&document.getElementById("dleprofilepopup")?($("#dleprofilepopup").dialog("open"),!1):(dle_user_profile=e,dle_user_profile_link=o,ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=profile",{name:e,skin:dle_skin,user_hash:dle_login_hash},(function(e){HideLoading(""),ShowPopupProfile(e,t)})),!1)}function FastSearch(){$("#story").attr("autocomplete","off"),$("#story").blur((function(){$("#searchsuggestions").fadeOut()})),$("#story").keyup((function(){var e=$(this).val();0==e.length?$("#searchsuggestions").fadeOut():dle_search_value!=e&&3<e.length&&(clearInterval(dle_search_delay),dle_search_delay=setInterval((function(){dle_do_search(e)}),600))}))}function dle_do_search(e){clearInterval(dle_search_delay),$("#searchsuggestions").remove(),$("body").append("<div id='searchsuggestions' style='display:none'></div>"),$.post(dle_root+"engine/ajax/controller.php?mod=search",{query:""+e,user_hash:dle_login_hash},(function(e){$("#searchsuggestions").html(e).fadeIn().css({position:"absolute",top:0,left:0}).position({my:"left top",at:"left bottom",of:"#story",collision:"fit flip"})})),dle_search_value=e}function ShowLoading(e){$("#loading-layer").remove(),$("body").append("<div id='loading-layer' style='display:none'></div>"),e?$("#loading-layer").html(e):$("#loading-layer").html(dle_act_lang[6]),e=($(window).width()-$("#loading-layer").width())/2;var o=($(window).height()-$("#loading-layer").height())/2;$("#loading-layer").css({left:e+"px",top:o+"px",position:"fixed",zIndex:"99"}),$("#loading-layer").fadeTo("slow",.6)}function HideLoading(e){$("#loading-layer").fadeOut("slow",(function(){$("#loading-layer").remove()}))}function ShowAllVotes(){return document.getElementById("dlevotespopup")?($("#dlevotespopup").dialog("open"),!1):($.ajaxSetup({cache:!1}),ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=allvotes&dle_skin="+dle_skin,(function(e){HideLoading(""),$("#dlevotespopup").remove(),$("body").append(e),$(".dlevotebutton").button(),$("#dlevotespopup").dialog({autoOpen:!0,show:"fade",hide:"fade",resizable:!1,dialogClass:"dle-popup-allvotes",width:600}),400<$("#dlevotespopupcontent").height()&&$("#dlevotespopupcontent").height(400),$("#dlevotespopup").dialog("option","height",$("#dlevotespopupcontent").height()+60),$("#dlevotespopup").dialog("option","position","center")})),!1)}function fast_vote(e){var o=$("#vote_"+e+" input:radio[name=vote_check]:checked").val();return void 0===o||(ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=vote",{vote_id:e,vote_action:"vote",vote_mode:"fast_vote",vote_check:o,dle_skin:dle_skin,user_hash:dle_login_hash},(function(o){HideLoading(""),$("#dle-vote_list-"+e).fadeOut(500,(function(){$(this).html(o),$(this).fadeIn(500)}))}))),!1}function AddIgnorePM(e,o){DLEconfirm(o,dle_confirm,(function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=pm",{id:e,action:"add_ignore",skin:dle_skin,user_hash:dle_login_hash},(function(e){return HideLoading(""),DLEalert(e,dle_info),!1}))}))}function DelIgnorePM(e,o){DLEconfirm(o,dle_confirm,(function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=pm",{id:e,action:"del_ignore",skin:dle_skin,user_hash:dle_login_hash},(function(o){return HideLoading(""),$("#dle-ignore-list-"+e).html(""),DLEalert(o,dle_info),!1}))}))}function subscribe(e){return DLEconfirm(dle_sub_agree,dle_confirm,(function(){ShowLoading(""),$.get(dle_root+"engine/ajax/controller.php?mod=commentssubscribe",{news_id:e,skin:dle_skin,user_hash:dle_login_hash},(function(e){HideLoading(""),e.success?DLEalert(e.info,dle_info):e.error&&DLEalert(e.errorinfo,dle_info)}),"json")})),!1}function media_upload(e,o,t,n){var i=(new Date).getTime(),d="none";return $("#mediaupload").remove(),$("body").append("<div id='mediaupload' title='"+text_upload+"' style='display:none'></div>"),$("#mediaupload").dialog({autoOpen:!0,width:710,resizable:!1,dialogClass:"modalfixed dle-popup-upload",open:function(d,l){$("#mediaupload").html("<iframe name='mediauploadframe' id='mediauploadframe' width='100%' height='550' src='"+dle_root+"engine/ajax/controller.php?mod=upload&area="+e+"&author="+o+"&news_id="+t+"&wysiwyg="+n+"&skin="+dle_skin+"&rndval="+i+"' frameborder='0' marginwidth='0' marginheight='0' allowtransparency='true'></iframe>"),$(".ui-dialog").draggable("option","containment","")},dragStart:function(e,o){d=$(".modalfixed").css("box-shadow"),$(".modalfixed").fadeTo(0,.6).css("box-shadow","none"),$("#mediaupload").css("visibility","hidden")},dragStop:function(e,o){$(".modalfixed").fadeTo(0,1).css("box-shadow",d),$("#mediaupload").css("visibility","visible")},beforeClose:function(e,o){$("#mediaupload").html("")}}),830<$(window).width()&&530<$(window).height()&&($(".modalfixed.ui-dialog").css({position:"fixed"}),$("#mediaupload").dialog("option","position",{my:"center",at:"center",of:window})),!1}function dropdownmenu(e,o,t,n){return window.event?event.cancelBubble=!0:o.stopPropagation&&o.stopPropagation(),(o=$("#dropmenudiv")).is(":visible")?(clearhidemenu(),o.fadeOut("fast"),!1):(o.remove(),$("body").append('<div id="dropmenudiv" style="display:none;position:absolute;z-index:100;width:165px;"></div>'),(o=$("#dropmenudiv")).html(t.join("")),n&&o.width(n),(t=$(document).width()-30)-(n=$(e).offset()).left<o.width()&&(n.left-=o.width()-$(e).width()),o.css({left:n.left+"px",top:n.top+$(e).height()+"px"}),o.fadeTo("fast",.9),o.mouseenter((function(){clearhidemenu()})).mouseleave((function(){delayhidemenu()})),$(document).one("click",(function(){hidemenu()})),!1)}function hidemenu(e){$("#dropmenudiv").fadeOut("fast")}function delayhidemenu(){delayhide=setTimeout("hidemenu()",1e3)}function clearhidemenu(){"undefined"!=typeof delayhide&&clearTimeout(delayhide)}jQuery((function(e){var o=!1,t=[];e(document).keydown((function(o){if(13==o.which&&o.ctrlKey){if(o.preventDefault(),window.getSelection)var t=window.getSelection();else document.getSelection?t=document.getSelection():document.selection&&(t=document.selection.createRange().text);if(""==t)return!1;if(255<t.toString().length)return DLEalert(dle_big_text,dle_info),!1;(o={})[dle_act_lang[3]]=function(){e(this).dialog("close")},o[dle_p_send]=function(){if(1>e("#dle-promt-text").val().length)e("#dle-promt-text").addClass("ui-state-error");else{var o=e("#dle-promt-text").val(),t=e("#orfom").text();e(this).dialog("close"),e("#dlepopup").remove(),e.post(dle_root+"engine/ajax/controller.php?mod=complaint",{seltext:t,text:o,user_hash:dle_login_hash,action:"orfo",url:window.location.href},(function(e){DLEalert("ok"==e?dle_p_send_ok:e,dle_info)}))}},e("#dlepopup").remove(),e("body").append("<div id='dlepopup' class='dle-promt' title='"+dle_orfo_title+"' style='display:none'><textarea name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;height:80px;'></textarea><div id='orfom' style='display:none'>"+t+"</div></div>"),e("#dlepopup").dialog({autoOpen:!0,width:600,resizable:!1,dialogClass:"modalfixed dle-popup-complaint",buttons:o}),e(".modalfixed.ui-dialog").css({position:"fixed"}),e("#dlepopup").dialog("option","position",{my:"center",at:"center",of:window})}})),setTimeout((function(){e("img[data-maxwidth]").each((function(){var t=e(this).width(),n=e(this).data("maxwidth");e(this)[0].naturalWidth&&(t=e(this)[0].naturalWidth),t>n&&(e(this).width(n),e(this).wrap('<a href="'+e(this).attr("src")+'" onclick="return hs.expand(this)"></a>'),"undefined"==typeof hs&&0==o&&(o=!0,e.getScript(dle_root+"engine/classes/highslide/highslide.js",(function(){hs.graphicsDir=dle_root+"engine/classes/highslide/graphics/",hs.numberOfImagesToPreload=0,hs.captionEval="this.thumb.alt",hs.showCredits=!1,hs.align="center",hs.transitions=["expand","crossfade"]}))))}))}),300),setTimeout((function(){e("div[data-dlebclicks]").each((function(){var o=e(this).data("dlebid");e(this).find("a").on("click",(function(){e.post(dle_root+"engine/ajax/controller.php?mod=adminfunction",{id:o,action:"bannersclick",user_hash:dle_login_hash})}))}))}),400),e("div[data-dlebviews]").each((function(){t.push(e(this).data("dlebid"))})),t.length&&setTimeout((function(){e.post(dle_root+"engine/ajax/controller.php?mod=adminfunction",{"ids[]":t,action:"bannersviews",user_hash:dle_login_hash})}),1e3)}));